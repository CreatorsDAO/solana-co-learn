<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-Solana-Co-Learn docs-doc-id-module6/randomness/randomising-loot-with-switchborar/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">ä½¿ç”¨Switchboardè¿›è¡ŒéšæœºåŒ–æˆ˜åˆ©å“ | Solana Co Learn</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.all-in-one-blockchain.xyz/solana-co-learn/Solana-Co-Learn/module6/randomness/randomising-loot-with-switchborar/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-Solana-Co-Learn-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-Solana-Co-Learn-current"><meta data-rh="true" property="og:title" content="ä½¿ç”¨Switchboardè¿›è¡ŒéšæœºåŒ–æˆ˜åˆ©å“ | Solana Co Learn"><meta data-rh="true" name="description" content="ç°åœ¨æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ç®€å•æˆ˜åˆ©å“ç®±çš„å®ç°è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªæ–°ç¨‹åºï¼Œç”¨äºåˆ›å»ºæˆ˜åˆ©å“ç®±å¹¶ä»ä¸­è·å–ç‰©å“ã€‚"><meta data-rh="true" property="og:description" content="ç°åœ¨æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ç®€å•æˆ˜åˆ©å“ç®±çš„å®ç°è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªæ–°ç¨‹åºï¼Œç”¨äºåˆ›å»ºæˆ˜åˆ©å“ç®±å¹¶ä»ä¸­è·å–ç‰©å“ã€‚"><link data-rh="true" rel="icon" href="/solana-co-learn/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.all-in-one-blockchain.xyz/solana-co-learn/Solana-Co-Learn/module6/randomness/randomising-loot-with-switchborar/"><link data-rh="true" rel="alternate" href="https://www.all-in-one-blockchain.xyz/solana-co-learn/Solana-Co-Learn/module6/randomness/randomising-loot-with-switchborar/" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.all-in-one-blockchain.xyz/solana-co-learn/Solana-Co-Learn/module6/randomness/randomising-loot-with-switchborar/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://WQYN7PW5BU-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/solana-co-learn/blog/rss.xml" title="Solana Co Learn RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/solana-co-learn/blog/atom.xml" title="Solana Co Learn Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Solana Co Learn" href="/solana-co-learn/opensearch.xml"><link rel="stylesheet" href="/solana-co-learn/assets/css/styles.540befb6.css">
<link rel="preload" href="/solana-co-learn/assets/js/runtime~main.6740ce72.js" as="script">
<link rel="preload" href="/solana-co-learn/assets/js/main.520c1370.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solana-co-learn/"><div class="navbar__logo"><img src="/solana-co-learn/img/my_logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/solana-co-learn/img/my_logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">All In One Solana</b></a><a class="navbar__item navbar__link" href="/solana-co-learn/awesome-solana-zh">Awesome Solana Zh</a><a class="navbar__item navbar__link" href="/solana-co-learn/Solana-Co-Learn">Solana Co Learn</a><a class="navbar__item navbar__link" href="/solana-co-learn/solana-development-course">Solana Development Course</a><a class="navbar__item navbar__link" href="/solana-co-learn/cookbook-zh">Solana Cookbook Zh</a><a class="navbar__item navbar__link" href="/solana-co-learn/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/CreatorsDAO/solana-co-learn.git" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solana-co-learn/Solana-Co-Learn/">Solana Co Learn</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solana-co-learn/Solana-Co-Learn/module1/">Solana åŸºç¡€ (ä¸Solanaç½‘ç»œé€šè¿‡rpcäº¤äº’)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Solana åŸºç¡€ (ä¸Solanaç½‘ç»œé€šè¿‡rpcäº¤äº’)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solana-co-learn/Solana-Co-Learn/module2/">Solana è¿›é˜¶ (SPL tokenä¸NFT)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Solana è¿›é˜¶ (SPL tokenä¸NFT)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solana-co-learn/Solana-Co-Learn/module3/">Solana Native å¼€å‘</a><button aria-label="Toggle the collapsible sidebar category &#x27;Solana Native å¼€å‘&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solana-co-learn/Solana-Co-Learn/module4/">PDAs ä¸CPIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;PDAs ä¸CPIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solana-co-learn/Solana-Co-Learn/module5/">æ·±å…¥Anchoræ¡†æ¶</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ·±å…¥Anchoræ¡†æ¶&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/solana-co-learn/Solana-Co-Learn/module6/">VRFå¯éªŒè¯éšæœºæ•°çš„åº”ç”¨</a><button aria-label="Toggle the collapsible sidebar category &#x27;VRFå¯éªŒè¯éšæœºæ•°çš„åº”ç”¨&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solana-co-learn/Solana-Co-Learn/module6/ship-week/">æŒ‘æˆ˜å‘¨</a><button aria-label="Toggle the collapsible sidebar category &#x27;æŒ‘æˆ˜å‘¨&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solana-co-learn/Solana-Co-Learn/module6/randomness/">éšæœºæ€§</a><button aria-label="Toggle the collapsible sidebar category &#x27;éšæœºæ€§&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/solana-co-learn/Solana-Co-Learn/module6/randomness/randomising-loot-with-switchborar/">ä½¿ç”¨Switchboardè¿›è¡ŒéšæœºåŒ–æˆ˜åˆ©å“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/solana-co-learn/Solana-Co-Learn/module6/randomness/build-a-randomiser/">ğŸ‘â€ğŸ—¨ æ„å»ºä¸€ä¸ªéšæœºå™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/solana-co-learn/Solana-Co-Learn/module6/randomness/opening-loot-boxes/">ğŸ å¼€å¯æˆ˜åˆ©å“ç®±</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed green"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solana-co-learn/Solana-Co-Learn/module6/finishing-touches/">æœ€åçš„ä½œå“</a><button aria-label="Toggle the collapsible sidebar category &#x27;æœ€åçš„ä½œå“&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ä½¿ç”¨Switchboardè¿›è¡ŒéšæœºåŒ–æˆ˜åˆ©å“</h1><p>ç°åœ¨æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ç®€å•æˆ˜åˆ©å“ç®±çš„å®ç°è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªæ–°ç¨‹åºï¼Œç”¨äºåˆ›å»ºæˆ˜åˆ©å“ç®±å¹¶ä»ä¸­è·å–ç‰©å“ã€‚</p><p>æˆ‘ä»¬å°†å®¡æŸ¥çš„è§£å†³æ–¹æ¡ˆä»£ç ä½äº<code>Anchor NFT Staking</code>å­˜å‚¨åº“çš„<code>solution-naive-loot-boxes</code>åˆ†æ”¯ä¹‹ä¸€ã€‚</p><p>æˆ‘å†æ¬¡å¼ºè°ƒï¼Œå»ºè®®ä½ è‡ªè¡Œå°è¯•æ“ä½œï¼Œè€Œä¸æ˜¯ç›´æ¥å¤åˆ¶ç²˜è´´è§£å†³æ–¹æ¡ˆä»£ç ã€‚</p><p>åœ¨programsç›®å½•ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å‘½ä»¤<code>anchor new &lt;program-name&gt;</code>æ¥åˆ›å»ºä¸€ä¸ªæ–°ç¨‹åºï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸º<code>lootbox-program</code>ã€‚</p><p>å¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼Œ<code>Anchor.toml</code>æ–‡ä»¶ä¸­<code>nft-staking</code>ç¨‹åºçš„IDå·²ç»å˜åŒ–äº†ï¼Œæˆ‘ä»¬è¿˜æ–°å¢äº†ä¸€ä¸ªloot boxç¨‹åºçš„IDã€‚ä½ éœ€è¦åœ¨è‡ªå·±çš„ç«¯æ›´æ–°è¿™ä¸¤ä¸ªIDã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å¯¹<a href="https://github.com/Unboxed-Software/anchor-nft-staking-program/blob/solution-naive-loot-boxes/programs/anchor-nft-staking/src/lib.rs?utm_source=buildspace.so&amp;utm_medium=buildspace_project" target="_blank" rel="noopener noreferrer">åŸå§‹è´¨æŠ¼è®¡åˆ’</a>æ‰€ä½œçš„ä¿®æ”¹ã€‚</p><p>å¦‚æœä½ å‘ä¸‹æ»šåŠ¨åˆ°<code>UserStakeInfo</code>å¯¹è±¡ï¼Œä½ ä¼šå‘ç°æˆ‘ä»¬æ·»åŠ äº†<code>total_earned</code>å­—æ®µã€‚å®ƒä¼šè·Ÿè¸ªç”¨æˆ·çš„è´¨æŠ¼æ—…ç¨‹ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œä»–ä»¬å°†èµšå–æ›´å¤šçš„å¥–åŠ±ï¼Œå¹¶ä¸”åœ¨è¾¾åˆ°æ–°çš„é‡Œç¨‹ç¢‘æ—¶ï¼Œå°†è·å¾—æ›´å¤šçš„æˆ˜åˆ©å“ç®±ç‰©å“ã€‚</p><p>åŒæ ·ç›¸å…³çš„æ˜¯<code>redeem_amount</code>ã€‚</p><p>é¦–å…ˆï¼Œä½ ä¼šæ³¨æ„åˆ°æœ‰äº›æ³¨é‡Šè¢«æ³¨é‡Šæ‰äº†ï¼Œè¿™ä»…æ˜¯ä¸ºäº†ç¡®ä¿æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„ä»¤ç‰Œè¿›è¡Œæµ‹è¯•ã€‚åœ¨æµ‹è¯•æ—¶ï¼Œè¯·ç¡®ä¿æ­£ç¡®åœ°æ³¨é‡Š/å–æ¶ˆæ³¨é‡Šä»£ç ã€‚</p><p>å¾€ä¸‹æ»šåŠ¨ä¸€ç‚¹ï¼Œä½ ä¼šçœ‹åˆ°è¿™ä¸€è¡Œæ–°æ·»åŠ çš„å†…å®¹ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stake_state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">total_earned </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> redeem_amount </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">u64</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™æ˜¯ä¸€ç§è·Ÿè¸ªæ€»æ”¶ç›Šçš„æ–¹æ³•ï¼Œä»<code>0</code>å¼€å§‹ï¼Œç„¶åä½ æ·»åŠ å·²å…‘æ¢çš„é‡‘é¢ï¼Œè¿™å°†æˆä¸ºæ–°çš„æ€»æ”¶ç›Šã€‚</p><p>åœ¨ä¸‹é¢çš„è§£é™¤è´¨æŠ¼åŠŸèƒ½ä¸­ï¼Œä½ è¿˜ä¼šå‘ç°æµ‹è¯•è¯´æ˜å’Œèµå›é‡‘é¢éƒ½å‘ç”Ÿäº†å˜åŒ–ã€‚</p><p>æœ€åï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­è¿˜æœ‰ä¸€ä¸ªæœ€åçš„æ›´æ”¹ã€‚å¦‚æœä½ çš„ç¨‹åºä¸æˆ‘çš„å®Œå…¨ç›¸åŒï¼Œå½“æˆ‘ä»¬è¿è¡Œå®ƒæ—¶ï¼Œç”±äºæ·»åŠ äº†è¿™ä¸ªæ–°å­—æ®µï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåœ¨å †æ ˆä¸­è€—å°½ç©ºé—´ã€‚æˆ‘é€‰æ‹©äº†ä¸€ä¸ªéšæœºè´¦æˆ·ï¼Œå¹¶åœ¨å…¶å‘¨å›´æ”¾ç½®äº†ä¸€ä¸ªç›’å­ï¼Œç¡®ä¿å®ƒè¢«åˆ†é…åˆ°å †ä¸­è€Œä¸æ˜¯æ ˆä¸­ï¼Œä»¥è§£å†³è¿™ä¸ªç©ºé—´é—®é¢˜ã€‚ä½ å¯ä»¥åœ¨ç”¨æˆ·çš„<code>stake ATA</code>ä¸Šè¿›è¡Œæ“ä½œï¼Œæˆ–è€…é€‰æ‹©ä»»ä½•å…¶ä»–è´¦æˆ·ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> user_stake_ata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Box</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Account</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">TokenAccount</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬è¿›å…¥æ–°çš„æˆ˜åˆ©å“ç®±è®¡åˆ’çš„æ–‡ä»¶ã€‚</p><p>åœ¨<code>Cargo.toml</code>ä¸­ï¼Œä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬ä¸ºæˆ‘ä»¬åŸå§‹çš„é”šå®šNFTè´¨æŠ¼ç¨‹åºæ·»åŠ äº†ä¸€ä¸ªæ–°çš„ä¾èµ–é¡¹ã€‚</p><div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">dependencies</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">anchor-lang</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key property" style="color:#36acaa">version</span><span class="token punctuation" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0.25.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token key property" style="color:#36acaa">features</span><span class="token punctuation" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;init-if-needed&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">anchor-spl</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.25.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">anchor-nft-staking</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key property" style="color:#36acaa">path</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../anchor-nft-staking&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token key property" style="color:#36acaa">features</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;cpi&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥ä¸»è¦çš„<a href="https://github.com/Unboxed-Software/anchor-nft-staking-program/blob/solution-naive-loot-boxes/programs/lootbox-program/src/lib.rs?utm_source=buildspace.so&amp;utm_medium=buildspace_project" target="_blank" rel="noopener noreferrer">æˆ˜åˆ©å“ç®±ç¨‹åºæ–‡ä»¶</a>ã€‚</p><p>åœ¨ä½¿ç”¨è¯­å¥ä¸­ï¼Œä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬ç°åœ¨å¯¼å…¥äº†é”šå®šNFTè´¨æŠ¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ£€æŸ¥æ€»æ”¶ç›Šå­—æ®µäº†ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">anchor_lang</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token namespace" style="opacity:0.7">prelude</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">anchor_nft_staking</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token class-name">UserStakeInfo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">anchor_spl</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">anchor_spl</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">associated_token</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token class-name">AssociatedToken</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">token</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">Burn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Mint</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">MintTo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Token</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">TokenAccount</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬åªæœ‰ä¸¤ä¸ªæŒ‡ä»¤ï¼Œ<code>open_lootbox</code>å’Œ<code>retrieve_item_from_lootbox</code>ã€‚æœ‰ä¸¤ä¸ªæŒ‡ä»¤çš„åŸå› æ˜¯ï¼Œå½“ä½ è¯·æ±‚â€œç»™æˆ‘ä¸€ä¸ªéšæœºçš„æˆ˜åˆ©å“â€æ—¶ï¼Œç¨‹åºå¿…é¡»å†³å®šè¦é“¸é€ å’Œèµ é€çš„æ‰€æœ‰å¯èƒ½ç‰©å“ï¼Œå®¢æˆ·ç«¯å¿…é¡»ä¼ å…¥æ‰€æœ‰å¯èƒ½çš„é“¸é€ è´¦æˆ·ã€‚è¿™ä½¿ç¨‹åºå˜å¾—ä¸é‚£ä¹ˆçµæ´»ï¼Œå¹¶å¢åŠ äº†æ£€æŸ¥ä¸€å †ä¸åŒè´¦æˆ·ä»¥ç¡®ä¿æœ‰é€‰é¡¹çš„å¼€é”€ï¼Œå¯¹å®¢æˆ·ç«¯æ¥è¯´ä¹Ÿéå¸¸éº»çƒ¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç”¨äºæ‰“å¼€æˆ˜åˆ©å“ç®±çš„æŒ‡ä»¤ï¼ŒåŸºæœ¬ä¸Šæ˜¯åœ¨æ‰€æœ‰å¯èƒ½çš„é“¸é€ é€‰é¡¹ä¸­ç»™æˆ‘ä¸€ä¸ªã€‚æˆ‘ä»¬è¿˜é€‰æ‹©äº†è¿™ä¸ªåœ°æ–¹ä½œä¸ºæ”¯ä»˜çš„åœ°æ–¹ï¼Œè¿™æ˜¯æˆ‘ä»¬å°†çƒ§æ¯<code>BLD</code>ä»£å¸çš„åœ°æ–¹ã€‚è‡³äºç¬¬äºŒä¸ªæŒ‡ä»¤ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå®¢æˆ·ç«¯çŸ¥é“ä»–ä»¬å°†è·å¾—å“ªä¸ªé“¸é€ ç‰©å“ï¼Œå¹¶å¯ä»¥ä¼ å…¥è¯¥ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä»ä¸­é“¸é€ ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ‰“å¼€æˆ˜åˆ©å“ç®±ï¼Œçœ‹çœ‹æˆ‘ä»¬éœ€è¦çš„è´¦å·ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">#[derive(Accounts)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token type-definition class-name">OpenLootbox</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[account(mut)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Signer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">account</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        init_if_needed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        space </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">std</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token namespace" style="opacity:0.7">mem</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">size_of</span><span class="token punctuation" style="color:#393A34">::</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">LootboxPointer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        seeds</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;lootbox&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">as_bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">key</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">as_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> lootbox_pointer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">LootboxPointer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> system_program</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> token_program</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Token</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Swap the next two lines out between prod/testing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// #[account(mut)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[account(</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        mut,</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        address=</span><span class="token attribute attr-name string" style="color:#e3116c">&quot;6YR1nuLqkk8VC1v42xJaPKvE9X9pnuqVAvthFUSDsMUL&quot;</span><span class="token attribute attr-name" style="color:#00a4db">.parse::&lt;Pubkey&gt;().unwrap()</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">    )]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> stake_mint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Mint</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[account(</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        mut,</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        associated_token::mint=stake_mint,</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        associated_token::authority=user</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">    )]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> stake_mint_ata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">TokenAccount</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> associated_token_program</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">AssociatedToken</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[account(</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        constraint=stake_state.user_pubkey==user.key(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">    )]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> stake_state</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">UserStakeInfo</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä½ ä¼šå‘ç°ä¸€ä¸ªåä¸º<code>lootbox_pointer</code>çš„æ–°å…ƒç´ ï¼Œè¿™æ˜¯ä¸€ç§å…¨æ–°çš„ç±»å‹ã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ªè–„è·å±æ€§ã€ä¸€ä¸ªå¸ƒå°”å€¼ç”¨æ¥è¡¨ç¤ºæ˜¯å¦å·²è¢«é¢†å–ï¼Œä»¥åŠä¸€ä¸ª<code>is_initialized</code>å±æ€§ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªä¸ç”¨æˆ·å…³è”çš„<code>PDAï¼ˆProgram-derived addressï¼‰</code>ï¼Œå› æ­¤å…¶ç§å­æ˜¯â€œæˆ˜åˆ©å“ç®±â€å’Œç”¨æˆ·ã€‚é€šè¿‡è¿™æ ·åšï¼Œå½“æˆ‘ä»¬é€‰ä¸­ä¸€ä¸ªè–„è·æ—¶ï¼Œæˆ‘ä»¬ä¸å°†æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨æŸä¸ªè´¦æˆ·ä¸­ã€‚å› æ­¤ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æˆ·å¯ä»¥æŸ¥è¯¢å¹¶æ£€ç´¢ç‰©å“çš„<code>PDA</code>ã€‚</p><p>æ­¤å¤–ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æŸè¡Œä»£ç çš„å¼€å¤´æœ‰ä¸€ä¸ªâ€œ<code>Swap</code>â€æ³¨é‡Šè¡Œã€‚ä¸ºäº†ä½¿æµ‹è¯•æ­£å¸¸è¿è¡Œï¼Œéœ€è¦å–æ¶ˆè¿™äº›è¡Œçš„æ³¨é‡Šï¼Œå¹¶æ³¨é‡Šæ‰å…¶ä»–åŒ…å«å¿ƒæ™ºåœ°å€çš„<code>stake_mint</code>å±æ€§è¡Œã€‚</p><p>ä¸‹é¢çš„<code>Rust</code>ä»£ç å±•ç¤ºäº†<code>LootboxPointer</code>ç»“æ„ï¼š</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">#[account]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token type-definition class-name">LootboxPointer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Pubkey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    claimed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    is_initialized</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†äº†è§£è¿™ä¸ªåŠŸèƒ½ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦éªŒè¯å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æˆ˜åˆ©å“ç®±ã€‚</p><p>ç”¨æˆ·è¾“å…¥ä¸€ä¸ªç›’å­å·ç ï¼Œç„¶åç¨‹åºä¼šè¿è¡Œä¸€ä¸ªæ— é™å¾ªç¯ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œå¦‚æœ<code>BLD</code>ä»¤ç‰Œçš„æ•°é‡è¿‡ä½ï¼Œæˆ‘ä»¬ä¼šè¿”å›é”™è¯¯ã€‚å…¶ä»–ä¸¤ç§å¯èƒ½çš„è·¯å¾„æ˜¯ï¼šè¦ä¹ˆå°†<code>loot_box</code>å·ç åŠ å€ï¼Œè¦ä¹ˆå¦‚æœåœ¨<code>loot_box</code>å·ç å’Œ<code>box_number</code>ä¹‹é—´æ‰¾åˆ°åŒ¹é…ï¼Œæˆ‘ä»¬è¦æ±‚<code>stake_state</code> <code>PDAs</code>çš„æ€»æ”¶ç›Šä¸å°‘äºä¼ å…¥çš„<code>box_number</code>ã€‚ç®€è€Œè¨€ä¹‹ï¼Œä½ å¿…é¡»èµšå¾—æ¯”ç›’å­å·ç æ›´å¤šã€‚</p><p>ä»¥ä¸‹æ˜¯æ‰“å¼€æˆ˜åˆ©å“ç®±çš„å‡½æ•°ï¼š</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">open_lootbox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Context</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">OpenLootbox</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> box_number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">u64</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> loot_box </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> loot_box </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> box_number </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token macro property" style="color:#36acaa">err!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">LootboxError</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">InvalidLootbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> loot_box </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> box_number </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token macro property" style="color:#36acaa">require!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stake_state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">total_earned </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> box_number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">LootboxError</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">InvalidLootbox</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            loot_box </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> loot_box </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property" style="color:#36acaa">require!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lootbox_pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">is_initialized </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lootbox_pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">claimed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">LootboxError</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">InvalidLootbox</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ç„¶åæˆ‘ä»¬ç»§ç»­è¿›è¡Œä»£å¸é”€æ¯ï¼Œé”€æ¯ä¸ç›’å­ç¼–å·æ‰€éœ€æ•°é‡ç›¸å¯¹åº”çš„ä»£å¸ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token namespace" style="opacity:0.7">token</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">burn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">CpiContext</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">token_program</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_account_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Burn</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stake_mint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_account_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            from</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stake_mint_ata</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_account_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            authority</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_account_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    box_number </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">u64</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">pow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¯¥å‡½æ•°è¿˜æ¶‰åŠä»£å¸é”€æ¯æ“ä½œï¼Œå³é”€æ¯ä¸ç›’å­ç¼–å·æ‰€éœ€æ•°é‡ç›¸åŒ¹é…çš„ä»£å¸ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†æè¿°å¯ç”¨è£…å¤‡ã€‚å½“å‰æ˜¯ç¡¬ç¼–ç çš„ï¼Œè¿™æ˜¯å®¢æˆ·ç«¯ä»£ç ä¸­<code>cache.json</code>æ–‡ä»¶çš„æ•°æ®ï¼Œä½†æœ‰æ›´çµæ´»çš„æ–¹å¼æ¥å®ç°ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> available_gear</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Pubkey</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token macro property" style="color:#36acaa">vec!</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;DQmrQJkErmfe6a1fD2hPwdLSnawzkdyrKfSUmd6vkC89&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">::</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Pubkey</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;A26dg2NBfGgU6gpFPfsiLpxwsV13ZKiD58zgjeQvuad&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">::</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Pubkey</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;GxR5UVvQDRwB19bCsB1wJh6RtLRZUbEAigtgeAsm6J7N&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">::</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Pubkey</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;3rL2p6LsGyHVn3iwQQYV9bBmchxMHYPice6ntp7Qw8Pa&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">::</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Pubkey</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;73JnegAtAWHmBYL7pipcSTpQkkAx77pqCQaEys2Qmrb2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">::</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Pubkey</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>éšåçš„ä»£ç ç‰‡æ®µå±•ç¤ºäº†ä¸€ç§éå®‰å…¨çš„ä¼ªéšæœºæ–¹æ³•ï¼Œè·å–å½“å‰æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ï¼Œç„¶åå¯¹5å–æ¨¡ï¼Œä»¥ç¡®å®šæˆ‘ä»¬åº”è¯¥é€‰æ‹©è¿™<code>5</code>ä¸ªç‰©å“ä¸­çš„å“ªä¸€ä¸ªã€‚ä¸€æ—¦é€‰æ‹©ï¼Œæˆ‘ä»¬å°†å…¶åˆ†é…ç»™æˆ˜åˆ©å“ç›’æŒ‡é’ˆã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> clock </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Clock</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">usize</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">clock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unix_timestamp </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">try_into</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Add in randomness later for selecting mint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> mint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> available_gear</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lootbox_pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mint</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lootbox_pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">claimed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lootbox_pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">is_initialized </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æˆ‘ä»¬å°†åœ¨åç»­ç‰ˆæœ¬ä¸­å¤„ç†çœŸæ­£çš„éšæœºæ€§ï¼Œä½†ç›®å‰è¿™ä¸ªç‰ˆæœ¬å·²ç»è¶³å¤Ÿã€‚æˆ‘ä»¬è¿˜å°†æ·»åŠ ä¸€ä¸ªæ£€æŸ¥ï¼Œä»¥ç¡®ä¿ç”¨æˆ·ä¸èƒ½åå¤æ‰“å¼€æˆ˜åˆ©å“ç®±ï¼Œä»¥è·å–ä»–ä»¬æƒ³è¦çš„ç‰©å“ã€‚ç°åœ¨ï¼Œåªè¦ç”¨æˆ·æ‰“å¼€æˆ˜åˆ©å“ç®±ï¼Œä»–ä»¬å°±å¯ä»¥çœ‹åˆ°å…¶ä¸­çš„ç‰©å“ã€‚æˆ‘ä»¬å¯ä»¥æ£€æŸ¥æˆ˜åˆ©å“ç®±æŒ‡é’ˆæ˜¯å¦å·²åˆå§‹åŒ–ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ— é—®é¢˜ï¼Œå¯ä»¥ç»§ç»­è¿›è¡Œã€‚è™½ç„¶æ¯æ¬¡å°è¯•éƒ½éœ€è¦ä»˜è´¹ï¼Œä½†æ˜¯å¦å°†å…¶ä½œä¸ºåŠŸèƒ½ç”±ä½ å†³å®šã€‚</p><p>å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬è½¬åˆ°æ£€ç´¢æŒ‡ä»¤å¹¶æŸ¥çœ‹æ‰€éœ€çš„è´¦æˆ·ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">#[derive(Accounts)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token type-definition class-name">RetrieveItem</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[account(mut)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Signer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">account</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        seeds</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;lootbox&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">as_bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">key</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">as_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bump</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        constraint</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">lootbox_pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">is_initialized</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> lootbox_pointer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">LootboxPointer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[account(</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        mut,</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        constraint=lootbox_pointer.mint==mint.key()</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">    )]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> mint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Mint</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[account(</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        init_if_needed,</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        payer=user,</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        associated_token::mint=mint,</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">        associated_token::authority=user</span><br></span><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">    )]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> user_gear_ata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">TokenAccount</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/// CHECK: Mint authority - not used as account</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">account</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        seeds</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;mint&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">as_bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> mint_authority</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">UncheckedAccount</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> token_program</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Token</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> associated_token_program</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">AssociatedToken</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> system_program</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> rent</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Sysvar</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token lifetime-annotation symbol" style="color:#36acaa">&#x27;info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Rent</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æœ‰å‡ ä»¶äº‹æƒ…æˆ‘ä»¬éœ€è¦æ˜ç¡®ã€‚&quot;<code>mint account</code>&quot; å¯ä»¥ç†è§£ä¸ºä»–ä»¬æ‰€è¦æ±‚çš„è£…å¤‡çš„å­˜å‚¨è´¦æˆ·ã€‚&quot;<code>mint authority</code>&quot; æ˜¯æˆ‘ä»¬åœ¨å®¢æˆ·ç«¯è„šæœ¬ä¸­åˆ†é…çš„ç”¨äºæ§åˆ¶é“¸å¸çš„ç¨‹åºæ´¾ç”Ÿè´¦æˆ·ï¼ˆ<code>PDA</code>ï¼‰ã€‚</p><p>å…³äºè¿™éƒ¨åˆ†çš„é€»è¾‘ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æˆ˜åˆ©å“ç®±æŒ‡é’ˆè¿˜æœªè¢«è®¤é¢†ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">retrieve_item_from_lootbox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Context</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">RetrieveItem</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property" style="color:#36acaa">require!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lootbox_pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">claimed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">LootboxError</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">AlreadyClaimed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æˆ˜åˆ©å“é“¸é€ ç»™ä½ ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token namespace" style="opacity:0.7">token</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">mint_to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token class-name">CpiContext</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new_with_signer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">token_program</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_account_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token class-name">MintTo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               mint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_account_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               to</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">user_gear_ata</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_account_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               authority</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mint_authority</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_account_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">b&quot;mint&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">as_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bumps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mint_authority&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æœ€åï¼Œæˆ‘ä»¬å°†è®¤é¢†æ ‡è®°è®¾ä¸ºçœŸå®ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lootbox_pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">claimed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>åˆ«å¿˜äº†æŸ¥çœ‹æˆ‘ä»¬åœ¨æ–‡ä»¶åº•éƒ¨åˆ›å»ºçš„è‡ªå®šä¹‰é”™è¯¯ä»£ç ã€‚</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">#[error_code]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token type-definition class-name">LootboxError</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[msg(</span><span class="token attribute attr-name string" style="color:#e3116c">&quot;Mint already claimed&quot;</span><span class="token attribute attr-name" style="color:#00a4db">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">AlreadyClaimed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[msg(</span><span class="token attribute attr-name string" style="color:#e3116c">&quot;Haven&#x27;t staked long enough for this loot box or invalid loot box number&quot;</span><span class="token attribute attr-name" style="color:#00a4db">)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">InvalidLootbox</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>è¿™ä¾¿æ˜¯æµç¨‹ã€‚å¦‚æœä½ è¿˜æ²¡å°è¯•å®æ–½è¿™ä¸ªï¼Œé‚£ä¹ˆå°è¯•ä¸€ä¸‹ï¼Œå¹¶è¿›è¡Œä¸€äº›æµ‹è¯•ã€‚å°½é‡è‡ªå·±ç‹¬ç«‹å®Œæˆã€‚</p><p>åœ¨è¿™ä¸ª<a href="https://github.com/Unboxed-Software/anchor-nft-staking-program/blob/solution-naive-loot-boxes/tests/anchor-nft-staking.ts?utm_source=buildspace.so&amp;utm_medium=buildspace_project" target="_blank" rel="noopener noreferrer">æ–‡ä»¶</a>ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°ç›¸å…³æµ‹è¯•ã€‚ä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ªæµ‹è¯•ï¼Œåˆ†åˆ«æ˜¯â€œéšæœºé€‰æ‹©ä¸€ç§é“¸å¸å£å‘³â€å’Œâ€œåˆ¶é€ æ‰€é€‰è£…å¤‡â€ã€‚è¯·æ³¨æ„åœ¨æˆ‘ä»¬æ ‡æ³¨â€œ<code>Swap</code>â€çš„åœ°æ–¹ï¼Œæ›´æ”¹ä»£ç è¡Œä»¥ä½¿æµ‹è¯•æ­£å¸¸å·¥ä½œã€‚ç„¶åè¿è¡Œæµ‹è¯•ï¼Œå®ƒä»¬åº”è¯¥éƒ½ä¼šæŒ‰é¢„æœŸè¿è¡Œã€‚</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="åˆ©ç”¨switchboardçš„éªŒè¯åŠŸèƒ½æ¥éšæœºåˆ†é…æˆ˜åˆ©å“">åˆ©ç”¨Switchboardçš„éªŒè¯åŠŸèƒ½æ¥éšæœºåˆ†é…æˆ˜åˆ©å“ğŸ”€<a href="#åˆ©ç”¨switchboardçš„éªŒè¯åŠŸèƒ½æ¥éšæœºåˆ†é…æˆ˜åˆ©å“" class="hash-link" aria-label="Direct link to åˆ©ç”¨Switchboardçš„éªŒè¯åŠŸèƒ½æ¥éšæœºåˆ†é…æˆ˜åˆ©å“ğŸ”€" title="Direct link to åˆ©ç”¨Switchboardçš„éªŒè¯åŠŸèƒ½æ¥éšæœºåˆ†é…æˆ˜åˆ©å“ğŸ”€">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä»»åŠ¡">ä»»åŠ¡<a href="#ä»»åŠ¡" class="hash-link" aria-label="Direct link to ä»»åŠ¡" title="Direct link to ä»»åŠ¡">â€‹</a></h3><p>æ—¢ç„¶ä½ å·²ç»æˆåŠŸå®ç°äº†ç®€å•çš„æˆ˜åˆ©å“ç®±ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥è€ƒè™‘é€šè¿‡`Switchboard`````````````````````æ¥å¢å¼ºéšæœºæ€§çš„çœŸå®æ€§ï¼ˆè™½ç„¶ä»æŠ€æœ¯ä¸Šè¯´ä»æ˜¯ä¼ªéšæœºï¼Œä½†æ¯”ä¹‹å‰çš„éšæœºæ€§è¦å¥½å‡ ä¸ªæ•°é‡çº§ï¼‰ã€‚</p><p><code>Switchboard</code>æ˜¯å»ºç«‹åœ¨<code>Solana</code>ä¸Šçš„åˆ†æ•£å¼é¢„è¨€æœºç½‘ç»œã€‚é¢„è¨€æœºæ˜¯åŒºå—é“¾ä¸ç°å®ä¸–ç•Œä¹‹é—´çš„è¿æ¥æ¡¥æ¢ï¼Œæä¾›äº†åœ¨å¤šä¸ªæ¥æºä¸­æ•°æ®è¾¾æˆå…±è¯†çš„æœºåˆ¶ã€‚åœ¨éšæœºæ€§æ–¹é¢ï¼Œè¿™æ„å‘³ç€æä¾›äº†ä¸€ä¸ªå¯éªŒè¯çš„ä¼ªéšæœºç»“æœï¼Œæ²¡æœ‰é¢„è¨€æœºåˆ™æ— æ³•è·å¾—ã€‚è¿™å¯¹äºå®ç°ä¸èƒ½â€œä½œå¼Šâ€çš„æˆ˜åˆ©å“ç®±è‡³å…³é‡è¦ã€‚</p><p>ä¸<code>Oracle</code>äº¤äº’æ˜¯ä¸€é¡¹æ¶µç›–æˆ‘ä»¬åœ¨æ•´ä¸ªè¯¾ç¨‹ä¸­æ‰€å­¦çš„æ‰€æœ‰å†…å®¹çš„ç»¼åˆç»ƒä¹ ã€‚é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li>ä¸<code>Oracle</code>ç¨‹åºè¿›è¡Œå®¢æˆ·ç«¯è®¾ç½®</li><li>ä½¿ç”¨ä½ è‡ªå·±çš„ç¨‹åºåˆå§‹åŒ–ä¸<code>Oracle</code>ç‰¹å®šçš„è´¦æˆ·ï¼ˆé€šå¸¸æ˜¯<code>PDAs</code>ï¼‰</li><li>ä½ çš„ç¨‹åºå‘<code>Oracle</code>ç¨‹åºå‘å‡º<code>CPI</code>è°ƒç”¨ï¼Œè¯·æ±‚ç‰¹å®šæ•°æ®ï¼Œä¾‹å¦‚ï¼Œå¯éªŒè¯çš„éšæœºç¼“å†²åŒº</li><li><code>Oracle</code>å¯ä»¥è°ƒç”¨ä½ çš„ç¨‹åºä»¥æä¾›æ‰€è¯·æ±‚ä¿¡æ¯çš„æŒ‡ä»¤</li><li>æ‰§è¡Œä½ çš„ç¨‹åºå¯¹æ‰€è¯·æ±‚æ•°æ®è¿›è¡Œæ“ä½œçš„æŒ‡ä»¤</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ–‡æ¡£">æ–‡æ¡£<a href="#æ–‡æ¡£" class="hash-link" aria-label="Direct link to æ–‡æ¡£" title="Direct link to æ–‡æ¡£">â€‹</a></h3><p>é¦–å…ˆï¼Œ<code>Switchboard</code>çš„æ–‡æ¡£åœ¨<code>Web3</code>ä¸Šä»ç„¶ç›¸å¯¹ç¨€ç¼ºï¼Œä½†ä½ å¯ä»¥åœ¨<a href="https://switchboard.xyz/" target="_blank" rel="noopener noreferrer">æ­¤å¤„</a>é˜…è¯»å…³äº<code>Switchboard</code>å¯éªŒè¯éšæœºæ€§çš„ç®€è¦æ¦‚è¿°ã€‚ç„¶åä½ åº”è¯¥æ·±å…¥ä»–ä»¬çš„é›†æˆæ–‡æ¡£ã€‚</p><p>ä½ å¯èƒ½è¿˜ä¼šæœ‰å¾ˆå¤šç–‘é—®ã€‚è¿™æ²¡å…³ç³»ï¼Œä¸è¦æ„Ÿåˆ°æ°”é¦ã€‚è¿™æ˜¯ä¸€ä¸ªåŸ¹å…»è‡ªä¸»è§£å†³é—®é¢˜èƒ½åŠ›çš„å¥½æœºä¼šã€‚</p><p>æ¥ä¸‹æ¥ä½ å¯ä»¥æŸ¥çœ‹ä»–ä»¬çš„é€æ­¥æŒ‡å—ï¼Œäº†è§£è·å–éšæœºæ€§çš„è¿‡ç¨‹ã€‚è¿™ä¼šå¼•å¯¼ä½ äº†è§£å¦‚ä½•è®¾ç½®<code>Switchboard</code>ç¯å¢ƒã€åˆå§‹åŒ–è¯·æ±‚å®¢æˆ·ç«¯ã€å‘å‡º<code>CPI</code>æŒ‡ä»¤ã€åœ¨ä½ çš„ç¨‹åºä¸­æ·»åŠ <code>Switchboard</code>å¯ä»¥è°ƒç”¨çš„æŒ‡ä»¤æ¥æä¾›éšæœºæ€§ç­‰æ­¥éª¤ã€‚</p><p><strong>æœ€åçš„å¤‡æ³¨</strong></p><p>è¿™ä¸ªä»»åŠ¡å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ã€‚è¿™æ˜¯æ•…æ„è®¾è®¡çš„ï¼Œæ˜¯å¯¹è¿‡å»å…­å‘¨åŠªåŠ›ç†è§£<code>Solana</code>çš„å·¥ä½œçš„æ€»ç»“ã€‚æˆ‘ä»¬è¿˜æä¾›äº†ä¸€äº›å…³äºå¦‚ä½•åœ¨æˆ˜åˆ©å“ç®±è®¡åˆ’ä¸­ä½¿ç”¨<code>Switchboard</code>çš„è§†é¢‘æ¦‚è§ˆã€‚</p><p>ä½ å¯ä»¥éšæ—¶è§‚çœ‹è¿™äº›è§†é¢‘ã€‚é€šå¸¸ï¼Œæˆ‘ä¼šå»ºè®®ä½ å…ˆå®Œæˆä¸€äº›ç‹¬ç«‹å·¥ä½œï¼Œä½†ç”±äº<code>Switchboard</code>çš„æ–‡æ¡£ç›¸å¯¹ç¨€ç¼ºï¼Œæ‰€ä»¥å°½æ—©æŸ¥çœ‹æ­¥éª¤è¯´æ˜å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚ç„¶è€Œï¼Œæˆ‘æƒ³æé†’ä½ ï¼Œä¸è¦ä»…ä»…å¤åˆ¶ç²˜è´´æˆ‘çš„è§£å†³æ–¹æ¡ˆã€‚ç›¸åï¼Œè§‚çœ‹æ­¥éª¤è¯´æ˜åï¼Œå°½é‡è‡ªå·±é‡æ–°åˆ›å»ºç±»ä¼¼çš„å†…å®¹ã€‚å¦‚æœä½ å‡†å¤‡åœ¨æˆ‘ä»¬å‘å¸ƒæ­¥éª¤è¯´æ˜ä¹‹å‰å‚è€ƒè§£å†³æ–¹æ¡ˆä»£ç ï¼Œä½ å¯ä»¥éšæ—¶æŸ¥çœ‹<a href="https://github.com/Unboxed-Software/anchor-nft-staking-program/tree/solution-randomize-loot?utm_source=buildspace.so&amp;utm_medium=buildspace_project" target="_blank" rel="noopener noreferrer">è¿™é‡Œ</a>çš„ <code>solution-randomize-loot branch</code>ã€‚</p><p>ä½ å¯èƒ½éœ€è¦è¶…è¿‡æœ¬å‘¨ç»“æŸå‰çš„æ—¶é—´æ¥å®Œæˆè¿™é¡¹ä»»åŠ¡ã€‚è¿™æ˜¯æ­£å¸¸çš„ï¼Œä¹Ÿå¯èƒ½éœ€è¦æ›´å¤šçš„æ—¶é—´æ¥è§£å†³é—®é¢˜ã€‚æ²¡æœ‰å…³ç³»</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/CreatorsDAO/solana-co-learn/tree/main/docs/Solana-Co-Learn/module6/randomness/randomising-loot-with-switchborar/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-09-11T16:03:35.000Z">Sep 11, 2024</time></b> by <b>v1xingyue</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/solana-co-learn/Solana-Co-Learn/module6/randomness/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">éšæœºæ€§</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/solana-co-learn/Solana-Co-Learn/module6/randomness/build-a-randomiser/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ğŸ‘â€ğŸ—¨ æ„å»ºä¸€ä¸ªéšæœºå™¨</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#åˆ©ç”¨switchboardçš„éªŒè¯åŠŸèƒ½æ¥éšæœºåˆ†é…æˆ˜åˆ©å“" class="table-of-contents__link toc-highlight">åˆ©ç”¨Switchboardçš„éªŒè¯åŠŸèƒ½æ¥éšæœºåˆ†é…æˆ˜åˆ©å“ğŸ”€</a><ul><li><a href="#ä»»åŠ¡" class="table-of-contents__link toc-highlight">ä»»åŠ¡</a></li><li><a href="#æ–‡æ¡£" class="table-of-contents__link toc-highlight">æ–‡æ¡£</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Products</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/CreatorsDAO/solana-co-learn/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/92B7aka3qr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/SolanaCreators" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/solana-co-learn/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/CreatorsDAO" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 All in One Solana site, Inc.</div></div></div></footer></div>
<script src="/solana-co-learn/assets/js/runtime~main.6740ce72.js"></script>
<script src="/solana-co-learn/assets/js/main.520c1370.js"></script>
</body>
</html>