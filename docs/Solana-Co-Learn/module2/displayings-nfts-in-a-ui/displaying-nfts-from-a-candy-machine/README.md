---
sidebar_position: 39
sidebar_label: ğŸ–¼ ä»ç³–æœæœºå±•ç¤ºNFTs
sidebar_class_name: green
---

# ğŸ–¼ ä»ç³–æœæœºå±•ç¤ºNFTs

ç°åœ¨æˆ‘ä»¬å·²ç»é“¸é€ äº†ä¸€ä¸ªNFTï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•é“¸é€ ä¸€ç³»åˆ—çš„NFTã€‚æˆ‘ä»¬å°†ä½¿ç”¨Candy Machineæ¥å®Œæˆè¿™ä¸ªä»»åŠ¡â€”â€”è¿™æ˜¯ä¸€ä¸ªSolanaç¨‹åºï¼Œå…è®¸åˆ›ä½œè€…å°†ä»–ä»¬çš„èµ„äº§ä¸Šé“¾ã€‚è¿™ä¸æ˜¯åˆ›å»ºç³»åˆ—çš„å”¯ä¸€æ–¹å¼ï¼Œä½†åœ¨Solanaä¸Šå®ƒæ˜¯æ ‡å‡†çš„ï¼Œå› ä¸ºå®ƒå…·æœ‰è®¸å¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œå¦‚æœºå™¨äººä¿æŠ¤å’Œå®‰å…¨éšæœºåŒ–ã€‚ä½ çŸ¥é“çœ‹åˆ°é—ªäº®çš„æ–°iPhoneæœ‰å¤šä»¤äººå…´å¥‹å—ï¼Ÿç¨€æœ‰çš„NFTæœ‰ç‚¹åƒé‚£æ ·ã€‚å¯¹äºä¼˜ç§€çš„è‰ºæœ¯å®¶æ¥è¯´ï¼Œå³ä½¿åªæ˜¯çœ‹ç€å®ƒä»¬ä¹Ÿå¾ˆæœ‰è¶£ã€‚æ¯•ç«Ÿï¼Œè‰ºæœ¯å°±æ˜¯ç”¨æ¥æ¬£èµçš„ï¼è®©æˆ‘ä»¬å¼„æ¸…æ¥šå¦‚æœæˆ‘ä»¬åªæœ‰Candy Machineçš„åœ°å€ï¼Œæˆ‘ä»¬å¦‚ä½•å±•ç¤ºNFTsã€‚

ä½ èƒ½çŒœåˆ°è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆä¸åŒå—ï¼Ÿæ˜¯çš„ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨SDKä¸Šä½¿ç”¨äº†ä¸€ç§ä¸åŒçš„æ–¹æ³•ï¼

![](./img/candy-machine-nft.png)

æ—¢ç„¶è¿™é‡Œæ²¡æœ‰é’±åŒ…ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦ä½¿ç”¨ `walletAdapterIdentity` ï¼Œåªéœ€è¦ä½¿ç”¨`metaplex`å¯¹è±¡å³å¯ã€‚

![](./img/find-nf.png)

æˆ‘ä»¬è¿™é‡Œåªæœ‰å‡ ä¸ªé€‰æ‹© - `findByAddress` æ˜¯æˆ‘ä»¬æƒ³è¦çš„ä¸€ä¸ªã€‚

![](./img/find-by-address.png)

ä¸æˆ‘ä»¬ä¸ºå•ä¸ªNFTæ‰€è·å¾—çš„ç±»ä¼¼ï¼Œæˆ‘ä»¬å°†è·å¾—æ•´ä¸ªç³–æœæœºå®ä¾‹çš„å…ƒæ•°æ®ã€‚ `items` å­—æ®µæ˜¯ç³–æœæœºä¸­æ‰€æœ‰NFTçš„æ•°ç»„ã€‚æ¯ä¸ªé¡¹ç›®éƒ½ä¸ä¼šåŒ…å«æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ï¼Œè€Œæ˜¯ä¼šæŒ‡å‘ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥ä»ä¸­è·å–èµ„äº§çš„URIã€‚

![](./img/find-by-address-result.png)

ç”±äºæ”¶è—å“å¯èƒ½éå¸¸åºå¤§ï¼Œæˆ‘ä»¬ä¸ä¼šä¸€æ¬¡æ€§è·å–æ‰€æœ‰çš„NFTã€‚ç›¸åï¼Œæˆ‘ä»¬å°†æ ¹æ®åˆ†é¡µç³»ç»Ÿä»…è·å–æˆ‘ä»¬æƒ³è¦å±•ç¤ºçš„NFTã€‚

è®©æˆ‘ä»¬æ¥ç»˜åˆ¶ä¸€äº›åƒç´ å§ï¼

## ğŸ¥ è¯·æ‹¿æ¥ä¸€ä¸ªç³–æœæœº


æ‚¨å¯ä»¥ç»§ç»­ä¸Šä¸€èŠ‚çš„è¿›åº¦ï¼Œæˆ–è€…ä½¿ç”¨ä¸Šæ¬¡æˆ‘ä»¬ä½¿ç”¨çš„ç›¸åŒæ¨¡æ¿ï¼ˆèµ·å§‹åˆ†æ”¯å³å¯ï¼‰ã€‚

å¿«è¿›å…¥ `FetchCandyMachine.tsx` ã€‚ä½ ä¼šçœ‹åˆ°ä¸€äº›è®¾ç½®å·²ç»ä¸ºä½ å‡†å¤‡å¥½äº†ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ `getPage` å‡½æ•°ä»ç³–æœæœºä¸Šè·å–â€œé¡µé¢â€ä¸Šçš„ç‰©å“ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è·å–ç³–æœæœºçš„å…ƒæ•°æ®è´¦æˆ·ã€‚

åœ¨ç©ºçš„ `fetchCandyMachine` å‡½æ•°ä¸Šæ–¹è®¾ç½® `metaplex` å¯¹è±¡çš„è¿æ¥

```js
export const FetchCandyMachine: FC = () => {
	// placeholder CMv2 address
  const [candyMachineAddress, setCandyMachineAddress] = useState("")
  const [candyMachineData, setCandyMachineData] = useState(null)
  const [pageItems, setPageItems] = useState(null)
  const [page, setPage] = useState(1)

  const { connection } = useConnection()
  const metaplex = Metaplex.make(connection)
  ```

åœ¨åˆ›å»ºæœ‰çŠ¶æ€å˜é‡æ—¶ï¼Œè¯·ç¡®ä¿æ·»åŠ æ‚¨çš„Candy Machineåœ°å€

```js
export const FetchCandyMachine: FC = () => {
  const [candyMachineAddress, setCandyMachineAddress] = useState("CM_ADDRESS_HERE")
  ...
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å®Œæˆ `fetchCandyMachine` ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¹‹å‰çœ‹åˆ°çš„ `findByAddress` æ–¹æ³•ã€‚

```js
export const FetchCandyMachine: FC = () => {
	...

  // fetch candymachine by address
  const fetchCandyMachine = async () => {

    // Set page to 1 - we wanna be at the first page whenever we fetch a new Candy Machine
    setPage(1)

    // fetch candymachine data
    try {
      const candyMachine = await metaplex
        .candyMachinesV2()
        .findByAddress({ address: new PublicKey(candyMachineAddress) })

      setCandyMachineData(candyMachine)
    } catch (e) {
      alert("Please submit a valid CMv2 address.")
    }
  }
	...
}
```


æ³¨æ„ï¼šMetaplex CLIçš„æœ€æ–°ç‰ˆæœ¬åœ¨å‡½æ•°è°ƒç”¨çš„æœ«å°¾ä¸éœ€è¦ `run()` ã€‚

ç°åœ¨æ˜¯é‡è¦çš„éƒ¨åˆ† - æµè§ˆæˆ‘ä»¬å°†è·å¾—çš„CMæ•°æ®ã€‚ä»¥ä¸‹æ˜¯ `getPage` å‡½æ•°çš„æ ·å­ï¼š

```js
export const FetchCandyMachine: FC = () => {
	...

	// paging
  const getPage = async (page, perPage) => {
    const pageItems = candyMachineData.items.slice(
      (page - 1) * perPage,
      page * perPage
    )

    // fetch metadata of NFTs for page
    let nftData = []
    for (let i = 0; i < pageItems.length; i++) {
      let fetchResult = await fetch(pageItems[i].uri)
      let json = await fetchResult.json()
      nftData.push(json)
    }

    // set state
    setPageItems(nftData)
  }
	...
}

```

æˆ‘ä»¬åœ¨è¿™é‡Œåšçš„æ˜¯å°† `items` æ•°ç»„åˆ‡å‰²æˆå¤§å°ä¸º10çš„å—ã€‚ç„¶åæˆ‘ä»¬è·å–é¡µé¢ä¸­æ¯ä¸ªNFTçš„å…ƒæ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ `nftData` ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬å°† `pageItems` çŠ¶æ€å˜é‡è®¾ç½®ä¸ºåˆšåˆšè·å–çš„ `nftData` ã€‚

è¿™æ„å‘³ç€æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåœ¨ä»»ä½•æ—¶å€™åªä¼šæ¸²æŸ“å½“å‰é¡µé¢çš„NFTã€‚ä¸é”™ï¼

è®©æˆ‘ä»¬å¡«å†™ `prev` å’Œ `next` å‡½æ•°ï¼š

```js
// previous page
const prev = async () => {
  if (page - 1 < 1) {
    setPage(1)
  } else {
    setPage(page - 1)
  }
}

// next page
const next = async () => {
  setPage(page + 1)
}
```

å½“ç”¨æˆ·ç‚¹å‡»â€œä¸Šä¸€ä¸ªâ€å’Œâ€œä¸‹ä¸€ä¸ªâ€æŒ‰é’®æ—¶ï¼Œè¿™äº›å°†ä¼šè¿è¡Œï¼Œè¿™äº›æŒ‰é’®åªä¼šåœ¨ `pageItems` ä¸ä¸ºç©ºæ—¶æ˜¾ç¤ºï¼ˆå³å½“æˆ‘ä»¬è·å–äº†ä¸€ä¸ªCMçš„NFTæ—¶ï¼‰ã€‚

ç°åœ¨æˆ‘ä»¬éœ€è¦ä¸€äº› `useEffects` æ¥å¼€å§‹ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸€å¼€å§‹å¯èƒ½ä¼šæœ‰ç‚¹å›°æƒ‘ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥è§£æã€‚

- 1. åœ¨é¡µé¢åŠ è½½æ—¶è¿è¡Œ `fetchCandyMachine` å‡½æ•°ï¼ˆå¦‚æœ `candyMachineAddress` ä¸ä¸ºç©ºï¼‰
- 2. æ¯å½“ä½¿ç”¨ `fetchCandyMachine` è·å–ç³–æœæœºæ—¶ï¼Œå°† `page` è®¾ç½®ä¸º1ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å¾—åˆ°ç¬¬ä¸€é¡µã€‚
- 3. æ¯å½“ `candyMachineData` æˆ– `page` å‘ç”Ÿå˜åŒ–ï¼ˆå³è¾“å…¥æ–°çš„CMåœ°å€æˆ–ç‚¹å‡»ä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªæŒ‰é’®ï¼‰ï¼ŒåŠ è½½é¡µé¢ã€‚

è¿™æ˜¯ä»£ç ä¸­çš„æ ·å­ï¼š

```js
export const FetchCandyMachine: FC = () => {
	...

  // fetch placeholder candy machine on load
  useEffect(() => {
    fetchCandyMachine()
  }, [])

  // fetch metadata for NFTs when page or candy machine changes
  useEffect(() => {
    if (!candyMachineData) {
      return
    }
    getPage(page, 9)
  }, [candyMachineData, page])

}
```

å¿«å» `localhost:3000` è¯•è¯•å§ï¼ä½ åº”è¯¥èƒ½çœ‹åˆ°ä½ çš„ç³–æœæœºä¸Šçš„NFTçš„ç¬¬ä¸€é¡µã€‚
